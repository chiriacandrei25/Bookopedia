import pandas as pd
from goodreads import db
from goodreads.models import Book, Author, AuthorBookLink
import requests
import json
from datetime import datetime
import xmltodict


'''
    OrderedDict([('id', '115943'), ('name', 'Richard Branson'), ('link', 'https://www.goodreads.com/author/show/115943.Richard_Branson'), ('fans_count', OrderedDict([('@type', 'integer'), ('#text', '1076')])), 
    ('author_followers_count', OrderedDict([('@type', 'integer'), ('#text', '1076')])),
     ('large_image_url', 'https://images.gr-assets.com/authors/1219198910p7/115943.jpg'), 
     ('image_url', 'https://images.gr-assets.com/authors/1219198910p5/115943.jpg'), 
     ('small_image_url', 'https://images.gr-assets.com/authors/1219198910p2/115943.jpg'), 
     ('about', "Sir Richard Charles Nicholas Branson is an English business magnate, best known for his 
     Virgin brand of over 360 companies. Branson's first successful business venture was at age 16, when he 
     published a magazine called Student. He then set up a record mail-order business in 1970. In 1972, he opened 
     a chain of record stores, Virgin Records, later known as Virgin Megastores and rebranded as zavvi in late 2007. 
     With his flamboyant and competitive style, Branson's Virgin brand grew rapidly during the 1980s - as he set up Virgin 
     Atlantic Airways and expanded the Virgin Records music label. Richard Branson is the 236th richest person according to 
     <i>Forbes</i>' 2008 list of billionaires as he has an estimated net worth of approximately $7.9 billion USD."), 
     ('influences', None), ('works_count', '87'), ('gender', 'male'), ('hometown', 'Blackheath, South London, England'), 
     ('born_at', '1950/07/18'), ('died_at', None), ('goodreads_author', 
    None), ('books', OrderedDict([('book', [OrderedDict([('id', OrderedDict([('@type', 'integer'), ('#text', '211099')])),
     ('isbn', '0812932293'), ('isbn13', '9780812932294'), ('text_reviews_count', OrderedDict([('@type', 'integer'),
      ('#text', '845')])), ('uri', 'kca://book/amzn1.gr.book.v1.ILQtlov7qf-KXkO2oHwP4A'), ('title', "Losing 
    My Virginity: How I've Survived, Had Fun, and Made a Fortune Doing Business My Way"), ('title_without_series', 
    "Losing My Virginity: How I've Survived, Had Fun, and Made a Fortune Doing Business My Way"), ('image_url', 
    'https://s.gr-assets.com/assets/nophoto/book/111x148-bcc042a9c91a29c1d680899eff700a03.png'), ('small_image_url', 
    'https://s.gr-assets.com/assets/nophoto/book/50x75-a91bf249278a81aabab721ef782c4a74.png'), ('large_image_url', None), ('link', 'https://www.goodreads.com/book/show/211099.Losing_My_Virginity'), ('num_pages', None), ('format', 'Paperback'), ('edition_information', None), ('publisher', 'Crown Business'), ('publication_day', '19'), ('publication_year', '1999'), ('publication_month', '10'), ('average_rating', '3.99'), ('ratings_count', '47570'), ('description', '<b>"Oh, screw it, let\'s do it."</b><br /><br />That\'s the philosophy that has allowed Richard Branson, in slightly more than twenty-five years, to spawn so many successful ventures. From the airline 
    business (Virgin Atlantic Airways), to music (Virgin Records and V2), to cola (Virgin Cola), to retail (Virgin Megastores), and nearly a hundred others, ranging from 
    financial services to bridal wear, Branson has a track record second to none.<br /><br />Losing My Virginity is the unusual, frequently outrageous autobiography of one of the great business geniuses of our time. When Richard Branson started his first business, he and his friends decided that "since we\'re complete virgins at business, let\'s call it just that: Virgin." Since then, Branson has written his own "rules" for success, creating a group of companies with a global presence, but no central headquarters, no management hierarchy, and minimal bureaucracy.<br /><br />Many of Richard Branson\'s companies--airlines, retailing, and cola are good examples--were started in the face of entrenched competition. The experts said, "Don\'t do it." But Branson found golden opportunities in markets in which customers have been ripped off or underserved, where confusion reigns, and the competition is complacent. <br />And in this stressed-out, overworked age, Richard Branson gives us a new model: a dynamic, hardworking, successful entrepreneur who lives life to the fullest. Family, friends, fun, and adventure are equally important as business in Branson\'s life. Losing My Virginity is a portrait of a productive, sane, balanced life, filled with rich and colorful stories:<br /><br /> Crash-landing his hot-air balloon in the Algerian desert, yet remaining determined to have another go at being the first to circle the globe<br /><br />Signing the Sex Pistols, Janet Jackson, the Rolling Stones, Boy George, and Phil Collins<br /><br />Fighting back when British Airways took on Virgin Atlantic and successfully suing this pillar of the British business establishment<br /><br />Swimming two miles to safety during a violent storm off the coast of Mexico<br /><br />Selling Virgin Records to save Virgin Atlantic<br /><br />Staging a rescue flight into Baghdad before the start of the Gulf War . . .<br /><br />And much more. Losing My Virginity is the ultimate tale of personal and 
    business survival from a man who combines the business prowess of Bill Gates and the promotional instincts of P. T. Barnum.'), ('authors', OrderedDict([('author', OrderedDict([('id', '115943'), ('name', 'Richard Branson'), ('role', None), ('image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1219198910p5/115943.jpg')])), ('small_image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1219198910p2/115943.jpg')])), ('link', 'https://www.goodreads.com/author/show/115943.Richard_Branson'), ('average_rating', '3.96'), ('ratings_count', '76254'), ('text_reviews_count', '3221')]))])), ('published', '1999'), ('work', OrderedDict([('id', '204315'), ('uri', 'kca://work/amzn1.gr.work.v1.ovQwsdTl3vNHaIb267hDgA')]))]), OrderedDict([('id', OrderedDict([('@type', 'integer'), ('#text', '198863')])), ('isbn', '0753510995'), ('isbn13', '9780753510995'), ('text_reviews_count', OrderedDict([('@type', 'integer'), ('#text', '591')])), ('uri', 'kca://book/amzn1.gr.book.v1.37oP5f3-_RCTjBgNgORh1w'), ('title', "Screw It, Let's Do It: Lessons In Life"), ('title_without_series', "Screw It, Let's Do It: Lessons In Life"), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1312059228l/198863._SX98_.jpg'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1312059228l/198863._SY75_.jpg'), ('large_image_url', None), ('link', 'https://www.goodreads.com/book/show/198863.Screw_It_Let_s_Do_It'), ('num_pages', '128'), ('format', 'Paperback'), ('edition_information', None), ('publisher', 'Virgin Books'), ('publication_day', '2'), ('publication_year', '2006'), ('publication_month', '3'), ('average_rating', '3.93'), ('ratings_count', '12459'), ('description', "Throughout my life 
    I have achieved many remarkable things. In <i>Screw It, Let's Do It</i>, I will share with you my ideas and the secrets of my success, but not simply because I hope they'll help you achieve your individual goals. <br />Today we are increasingly aware of the effects of our actions on the environment, and I strongly believe that we 
    each have a responsibility, as individuals and organisations, to <i>do no harm</i>. I will draw on Gaia Capitalism to explain why we need to take stock of how we may 
    be damaging the environment, and why it is up to big companies like Virgin to lead the way in a more holistic approach to business. <br />In <i>Screw It, Let's Do It</i> I'll be looking forwards to the future. A lot has changed since I founded Virgin in 1968, and I'll explain how I intend to take my business and my ideas to the next level and the new and exciting areas - such as launching Virgin Fuels - into which Virgin is currently moving. <br />But I have also brought together all the important lessons, good advice and inspirational adages that have helped me along the road to success. <br />Ironically, I have never been one to do things by the book, but I have been inspired and influenced by many remarkable people. I hope that you too might find a little inspiration between these pages."), ('authors', OrderedDict([('author', OrderedDict([('id', '115943'), ('name', 'Richard Branson'), ('role', None), ('image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1219198910p5/115943.jpg')])), ('small_image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1219198910p2/115943.jpg')])), ('link', 'https://www.goodreads.com/author/show/115943.Richard_Branson'), ('average_rating', '3.96'), ('ratings_count', '76254'), ('text_reviews_count', '3221')]))])), ('published', '2006'), ('work', OrderedDict([('id', '192373'), ('uri', 'kca://work/amzn1.gr.work.v1.VUK3pCtoTfrJU51Nt6AJlA')]))]), OrderedDict([('id', OrderedDict([('@type', 'integer'), ('#text', '22129114')])), ('isbn', '1591847370'), ('isbn13', '9781591847373'), ('text_reviews_count', OrderedDict([('@type', 'integer'), ('#text', '357')])), ('uri', 'kca://book/amzn1.gr.book.v1.99PO1ZOglbxw98fNhvd-xQ'), ('title', 'The Virgin Way: Everything I Know About Leadership'), ('title_without_series', 'The Virgin Way: Everything I Know About Leadership'), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1404477771l/22129114._SX98_.jpg'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1404477771l/22129114._SY75_.jpg'), ('large_image_url', None), ('link', 'https://www.goodreads.com/book/show/22129114-the-virgin-way'), ('num_pages', '400'), ('format', 'Hardcover'), ('edition_information', None), ('publisher', 'Portfolio'), ('publication_day', '9'), ('publication_year', '2014'), ('publication_month', '9'), ('average_rating', '4.00'), ('ratings_count', '5611'), 
    ('description', 'While building the Virgin Group over forty years,\xa0Richard Branson has never shied away from seemingly outlandish\xa0challenges that others (including his own colleagues\xa0on several occasions) considered sheer lunacy. He has taken\xa0on giants like British Airways and won, and monsters like\xa0Coca-Cola and lost.<br />Now Branson gives an inside look at his strikingly different\xa0swashbuckling style of leadership. Learn how fun, family,\xa0passion, and the dying art of listening are key components to\xa0what his extended family of employees around the world have\xa0always dubbed (with a wink) the “Virgin Way.”<br /><br /><br />This unique perspective comes from a man who dropped\xa0out of school at sixteen, suffers from dyslexia, and has never\xa0worked for anyone but himself. He may be famous for thinking\xa0outside the box—an expression he despises—but Branson\xa0asserts that “you’ll never have to think outside the box if you\xa0refuse to let anyone build one around you.”<br /><br /><br />This is a unique book on leadership from someone who\xa0readily admits he has never read a book on leadership in his\xa0life. So expect the unexpected.'), ('authors', OrderedDict([('author', OrderedDict([('id', '115943'), ('name', 'Richard Branson'), ('role', None), ('image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1219198910p5/115943.jpg')])), ('small_image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1219198910p2/115943.jpg')])), ('link', 'https://www.goodreads.com/author/show/115943.Richard_Branson'), ('average_rating', '3.96'), ('ratings_count', '76254'), ('text_reviews_count', '3221')]))])), ('published', '2014'), ('work', OrderedDict([('id', '41475342'), ('uri', 'kca://work/amzn1.gr.work.v1.s4s9ByeW7OcnYKPlirYYlw')]))]), OrderedDict([('id', OrderedDict([('@type', 'integer'), ('#text', '15705584')])), ('isbn', OrderedDict([('@nil', 'true')])), ('isbn13', OrderedDict([('@nil', 'true')])), ('text_reviews_count', OrderedDict([('@type', 'integer'), ('#text', '177')])), ('uri', 'kca://book/amzn1.gr.book.v1.XHwMiohQK7uY2RP4_vWRhQ'), ('title', "Like a Virgin: Secrets They Won't Teach You at Business School"), ('title_without_series', "Like a Virgin: Secrets They Won't Teach You at Business School"), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1339691782l/15705584._SX98_.jpg'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1339691782l/15705584._SY75_.jpg'), ('large_image_url', None), ('link', 'https://www.goodreads.com/book/show/15705584-like-a-virgin'), ('num_pages', '343'), ('format', 'Paperback'), ('edition_information', None), ('publisher', 'Virgin'), ('publication_day', None), ('publication_year', '2012'), ('publication_month', None), ('average_rating', '3.78'), ('ratings_count', '2578'), ('description', "Length: 7 hrs and 55 mins<br /><br />Business advice from the best in the business<br /><br />Looking for advice in setting up your own company, improving your career prospects, or developing your leadership skills? Why not ask Richard Branson?<br /><br />In Like a Virgin: Secrets They Won't Teach You at Business School, Richard distils and shares the wisdom and experience 
    that have made him one of the world's most recognised and respected entrepreneurs. From his top tips on succeeding in business to some hard-hitting opinions on the global finance crisis, this book brings together his best advice on all things business.<br /><br />It's business school, the Branson way."), ('authors', OrderedDict([('author', OrderedDict([('id', '115943'), ('name', 'Richard Branson'), ('role', None), ('image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1219198910p5/115943.jpg')])), ('small_image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1219198910p2/115943.jpg')])), ('link', 'https://www.goodreads.com/author/show/115943.Richard_Branson'), ('average_rating', '3.96'), ('ratings_count', '76254'), ('text_reviews_count', '3221')]))])), ('published', '2012'), ('work', OrderedDict([('id', '21368488'), ('uri', 'kca://work/amzn1.gr.work.v1.vOS5Yy0_qwgDOvrk_084_A')]))]), OrderedDict([('id', OrderedDict([('@type', 'integer'), ('#text', '4065231')])), ('isbn', '1905264437'), ('isbn13', '9781905264438'), ('text_reviews_count', OrderedDict([('@type', 'integer'), ('#text', '128')])), ('uri', 'kca://book/amzn1.gr.book.v1.TSpOuCMZotlkopOEBfY9KQ'), ('title', 'Business Stripped Bare: Adventures of a Global Entrepreneur'), ('title_without_series', 'Business Stripped Bare: Adventures of a Global Entrepreneur'), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1327703212l/4065231._SX98_.jpg'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1327703212l/4065231._SY75_.jpg'), ('large_image_url', None), ('link', 'https://www.goodreads.com/book/show/4065231-business-stripped-bare'), ('num_pages', '352'), ('format', 'Hardcover'), ('edition_information', None), ('publisher', 'Virgin Books'), ('publication_day', '18'), ('publication_year', '2008'), ('publication_month', '9'), ('average_rating', '3.83'), 
    ('ratings_count', '2233'), ('description', "From its creation as a mail-order record company to the literal launch of Virgin Galactic, today Virgin is one of the premier 'way-of-life' brands in the world, trusted and enjoyed by many millions of people.<br /><br /><br /><br /><br /><br />In <i>Business Stripped Bare</i>, Sir Richard Branson shares the inside track on his life in business and reveals the incredible truth about his most risky, brilliant and audacious deals. Discover why Virgin tried to take on one of the world's biggest superbrands, how Virgin Mobile USA holds the record as the fastest company in history to generate revenues of over one billion dollars (faster than Microsoft, Google and Amazon) and how Richard is the only person in the world to have built eight billion-dollar companies from scratch in eight different sectors.<br /><br /><br /><br /><br /><br />What qualities does Richard look for in the people he hires? How does he manage a crisis? Who are the entrepreneurs he most admires? Find out the true story behind Virgin Blue's success in Australia, what really happened when Virgin bid for Northern Rock and why Richard believes all businesses must work with governments to tackle climate change and invest in the future of our planet.<br /><br /><br /><br /><br /><br />Combining invaluable advice with the remarkable and candid inside stories of Virgin's greatest achievements, as well as some of its setbacks, <i>Business Stripped Bare </i>is a dynamic, inspirational and truly original guide to success in business and in life. Whether you are an executive, an entrepreneur or are just starting out, Richard strips business down to show how you can succeed and make a difference."), ('authors', OrderedDict([('author', OrderedDict([('id', '115943'), ('name', 'Richard Branson'), ('role', None), ('image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1219198910p5/115943.jpg')])), ('small_image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1219198910p2/115943.jpg')])), ('link', 'https://www.goodreads.com/author/show/115943.Richard_Branson'), ('average_rating', '3.96'), ('ratings_count', '76254'), ('text_reviews_count', '3221')]))])), ('published', '2008'), ('work', OrderedDict([('id', '4112303'), ('uri', 'kca://work/amzn1.gr.work.v1.TrbmyXWY5lj2S1JL5-23eg')]))]), OrderedDict([('id', OrderedDict([('@type', 'integer'), ('#text', '34626372')])), ('isbn', '0735219427'), ('isbn13', '9780735219427'), ('text_reviews_count', OrderedDict([('@type', 'integer'), ('#text', '147')])), ('uri', 'kca://book/amzn1.gr.book.v1.Vu403VJnCi76tiPlV1LPSw'), ('title', 'Finding My Virginity: The New Autobiography'), ('title_without_series', 'Finding My Virginity: The New Autobiography'), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1501508369l/34626372._SX98_.jpg'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1501508369l/34626372._SY75_.jpg'), ('large_image_url', None), ('link', 'https://www.goodreads.com/book/show/34626372-finding-my-virginity'), ('num_pages', '471'), ('format', 'Hardcover'), ('edition_information', None), ('publisher', 'Portfolio'), ('publication_day', '10'), ('publication_year', '2017'), ('publication_month', '10'), ('average_rating', '4.13'), ('ratings_count', '2140'), ('description', '<b>Global business icon Richard Branson has written many books, 
    but none have been more popular than his first memoir, 1998\'s <i>Losing My Virginity</i>. Now he\'s finally publishing his second volume of memoirs, covering all of 
    his fascinating ups and downs of the past two decades.</b><br /><b> </b><br /> In the two decades since Richard Branson wrote <i>Losing My Virginity</i>, his life and company have changed significantly. Now he brings his life story up to date, including all the successes and failures of ventures such as Virgin Galactic. He also shares his personal, intimate thoughts on five decades as the world\'s ultimate entrepreneur, and his shift to focusing more and more on public service. <i>Virginity Regained </i>shows how Branson created hundreds of different companies, going from a houseboat to his own private island. Join him as he juggles working life with raising his children, sustaining his marriage, and creating a unique company culture. Discover how he created a new life on Necker Island, while continuing to grow the Virgin brand into all corners of the world. Get the real story behind his encounters with everyone from Bill Gates and Rupert Murdoch to Nelson Mandela and Beyonce.<br /><br />Go behind the scenes as Branson creates the world\'s first commercial spaceline, Virgin Galactic; handles the biggest crisis of his career; and makes world record attempts on land, sea and air. He even discusses what it\'s like for the original business hippy to become a doting "grand-dude" to his three grandchildren.'), ('authors', OrderedDict([('author', OrderedDict([('id', '115943'), ('name', 'Richard Branson'), ('role', None), ('image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1219198910p5/115943.jpg')])), ('small_image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1219198910p2/115943.jpg')])), ('link', 'https://www.goodreads.com/author/show/115943.Richard_Branson'), ('average_rating', '3.96'), ('ratings_count', '76254'), ('text_reviews_count', '3221')]))])), ('published', '2017'), ('work', OrderedDict([('id', '56778818'), ('uri', 'kca://work/amzn1.gr.work.v1.DW3qxwO03Og4LtYRbfih-w')]))]), OrderedDict([('id', OrderedDict([('@type', 'integer'), ('#text', '12357518')])), ('isbn', '0753539799'), ('isbn13', '9780753539798'), ('text_reviews_count', 
    OrderedDict([('@type', 'integer'), ('#text', '111')])), ('uri', 'kca://book/amzn1.gr.book.v1.cZmvYn7SjDBm1dCMb1aaRw'), ('title', 'Screw Business As Usual'), ('title_without_series', 'Screw Business As Usual'), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1333587074l/12357518._SX98_.jpg'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1333587074l/12357518._SY75_.jpg'), ('large_image_url', None), ('link', 'https://www.goodreads.com/book/show/12357518-screw-business-as-usual'), ('num_pages', '357'), ('format', 'Paperback'), ('edition_information', None), ('publisher', 'Virgin Books'), ('publication_day', '1'), ('publication_year', '2011'), ('publication_month', '12'), ('average_rating', '3.66'), ('ratings_count', '1361'), ('description', 
    'Can we bring more meaning to our lives and help change the world at the same time? Richard Branson, at his brilliant and motivating best, reveals how with his exciting new vision for the future. It is time to turn capitalism upside down – to shift our values, to switch from a profit focus to caring for people, communities and the planet.<br /><br />With inspiration for everyone, <i>Screw Business As Usual</i> shows how easy it is for both businesses and individuals to embark on a whole new way of doing things, solving major problems and turning our work into something we both love and are proud of.'), ('authors', OrderedDict([('author', OrderedDict([('id', '115943'), ('name', 'Richard Branson'), ('role', None), ('image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1219198910p5/115943.jpg')])), ('small_image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1219198910p2/115943.jpg')])), ('link', 'https://www.goodreads.com/author/show/115943.Richard_Branson'), ('average_rating', '3.96'), ('ratings_count', '76254'), ('text_reviews_count', '3221')]))])), ('published', '2011'), ('work', OrderedDict([('id', '17337348'), ('uri', 'kca://work/amzn1.gr.work.v1.v2ugl7hyHTOECjWFFOLzZQ')]))]), OrderedDict([('id', OrderedDict([('@type', 
    'integer'), ('#text', '211100')])), ('isbn', '0582512247'), ('isbn13', '9780582512245'), ('text_reviews_count', OrderedDict([('@type', 'integer'), ('#text', '29')])), ('uri', 'kca://book/amzn1.gr.book.v1.Sh1I9uwlz8dENxhHnxrHrQ'), ('title', 'Sir Richard Branson: The Autobiography'), ('title_without_series', 'Sir Richard Branson: The Autobiography'), ('image_url', 'https://s.gr-assets.com/assets/nophoto/book/111x148-bcc042a9c91a29c1d680899eff700a03.png'), ('small_image_url', 'https://s.gr-assets.com/assets/nophoto/book/50x75-a91bf249278a81aabab721ef782c4a74.png'), ('large_image_url', None), ('link', 'https://www.goodreads.com/book/show/211100.Sir_Richard_Branson'), ('num_pages', '112'), ('format', None), ('edition_information', None), ('publisher', None), ('publication_day', None), ('publication_year', None), ('publication_month', None), ('average_rating', '4.11'), ('ratings_count', '794'), ('description', None), ('authors', OrderedDict([('author', OrderedDict([('id', '115943'), ('name', 'Richard Branson'), ('role', None), ('image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1219198910p5/115943.jpg')])), ('small_image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1219198910p2/115943.jpg')])), ('link', 'https://www.goodreads.com/author/show/115943.Richard_Branson'), ('average_rating', '3.96'), ('ratings_count', '76254'), ('text_reviews_count', '3221')]))])), ('published', None), ('work', OrderedDict([('id', '204316'), ('uri', 'kca://work/amzn1.gr.work.v1.lHhiqsZTaWr1s_nUY43Jfw')]))]), OrderedDict([('id', OrderedDict([('@type', 'integer'), ('#text', '8270173')])), ('isbn', '0753519860'), ('isbn13', '9780753519868'), ('text_reviews_count', OrderedDict([('@type', 'integer'), ('#text', '17')])), ('uri', 'kca://book/amzn1.gr.book.v1.ofZQD57_8sJjyK02m25kgw'), ('title', 'Reach for the Skies: Ballooning, Birdmen And Blasting into Space'), ('title_without_series', 'Reach for the Skies: Ballooning, Birdmen And Blasting into Space'), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1274518452l/8270173._SX98_.jpg'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1274518452l/8270173._SY75_.jpg'), ('large_image_url', None), ('link', 'https://www.goodreads.com/book/show/8270173-reach-for-the-skies'), ('num_pages', '352'), ('format', 'Paperback'), ('edition_information', None), ('publisher', 'Virgin Books'), ('publication_day', '1'), ('publication_year', '2010'), ('publication_month', '6'), ('average_rating', '3.83'), ('ratings_count', '365'), ('description', "As far back as stories go, pioneers have reached for the skies. In the last two hundred years, they have mastered the air and made the modern world possible. Today they are bringing outer space within our reach. They're inventors and toymakers, amateurs and adventurers, visionaries, dreamers and, yes, crackpots. Some have called them irresponsible, even dangerous. But I have met many of them. I have worked with them, and funded them, and flown with them. I admire them, and trust them, and I think they and their kind are our future. In this book I look at the history of flight through the stories and people who have inspired me throughout my life. In these pages you will find tales of miraculous rescues; of records made and broken; of surprising feats of endurance and survival, including some of my own adventures, as well as developments in the future of air (and space) travel. It is a story of pioneers, and of course it includes the world famous Montgolfiers and the Wright brothers. But I also want to describe some of the lesser-known trailblazers -- people like Tony Jannus, who in 1914 created the world's first scheduled commercial flight, flying his passengers over the waters of Tampa Bay at an altitude of just fifty feet."), ('authors', OrderedDict([('author', OrderedDict([('id', '115943'), ('name', 'Richard Branson'), ('role', None), ('image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1219198910p5/115943.jpg')])), ('small_image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1219198910p2/115943.jpg')])), ('link', 'https://www.goodreads.com/author/show/115943.Richard_Branson'), ('average_rating', '3.96'), ('ratings_count', '76254'), ('text_reviews_count', '3221')]))])), ('published', '2010'), ('work', OrderedDict([('id', '13118303'), ('uri', 'kca://work/amzn1.gr.work.v1.C9FfkmfXuQNN9Di266YtcQ')]))]), OrderedDict([('id', OrderedDict([('@type', 'integer'), ('#text', '3198484')])), ('isbn', '1905264429'), ('isbn13', '9781905264421'), ('text_reviews_count', OrderedDict([('@type', 'integer'), ('#text', '7')])), ('uri', 'kca://book/amzn1.gr.book.v1.9VJWwiVMpX7Q9LUqeyrywg'), ('title', 'The Adventure of Business'), ('title_without_series', 'The Adventure of Business'), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1320516351l/3198484._SX98_.jpg'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1320516351l/3198484._SX50_.jpg'), ('large_image_url', None), ('link', 'https://www.goodreads.com/book/show/3198484-the-adventure-of-business'), ('num_pages', '352'), ('format', 'Hardcover'), ('edition_information', None), ('publisher', 'Virgin Books'), ('publication_day', '16'), ('publication_year', '2010'), ('publication_month', '8'), ('average_rating', '3.81'), ('ratings_count', '53'), ('description', "The biggest business publication of 2009 — Branson's business secrets now in paperback.<br /><br />In <b>Business Stripped Bare</b>, Sir Richard Branson shares the inside track on his life in business and reveals the incredible truth about his most risky, brilliant and audacious deals. Discover why Virgin tried to take on one of the world's biggest superbrands, how Virgin Mobile USA holds the record as the fastest company in history to generate revenues of over one billion dollars (faster than Microsoft, Google and Amazon) and how Richard is the only person in the world to have built eight billion-dollar companies from scratch in eight different sectors.<br /><br />Combining invaluable advice with the remarkable and candid inside stories of Virgin's greatest achievements, as well as some of its setbacks, <b>Business Stripped Bare</b> is a dynamic, inspirational and truly original guide to success 
    in business and in life. Whether you are an executive, an entrepreneur or are just starting out, Richard strips business down to show how you can succeed and make a difference.<br /><br /><br /><i>From the Trade Paperback edition.</i>"), ('authors', OrderedDict([('author', OrderedDict([('id', '115943'), ('name', 'Richard Branson'), ('role', None), ('image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1219198910p5/115943.jpg')])), ('small_image_url', 
    OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1219198910p2/115943.jpg')])), ('link', 'https://www.goodreads.com/author/show/115943.Richard_Branson'), ('average_rating', '3.96'), ('ratings_count', '76254'), ('text_reviews_count', '3221')]))])), ('published', '2010'), ('work', OrderedDict([('id', '3231680'), ('uri', 'kca://work/amzn1.gr.work.v1.7-GvJALVLTRBrEUD07D3Rw')]))])])]))])
'''


def get_author(authorInfo, author_ids):
    author_id = author_ids.get(int(authorInfo.get('id')))
    if author_id is not None:
        author = Author.query.get(author_id)
    else:
        query_url = "https://www.goodreads.com/author/show.xml?key=3RhAfUy69AUuQhOv1gTcA&id=" +\
                    authorInfo.get('id')
        resp = requests.get(query_url).content
        resp_dict = xmltodict.parse(resp)
        authorInfo = resp_dict.get('GoodreadsResponse').get('author')
        author = Author(name=authorInfo.get('name'), small_image_url=authorInfo.get('small_image_url'),
                        image_url=authorInfo.get('image_url'), big_image_url=authorInfo.get('big_image_url'),
                        about=authorInfo.get('about'), born_at=authorInfo.get('born_at'),
                        died_at=authorInfo.get('died_at'), hometown=authorInfo.get('hometown'))
        db.session.add(author)
        db.session.commit()
        author_ids[int(authorInfo.get('id'))] = author.id
    return author


def load_books():
    raw = pd.read_csv('books_metadata/books.csv')
    cnt = 0
    nr_books = 0
    author_ids = {}
    for _, row in raw.iterrows():
        query_url = "https://www.goodreads.com/book/show.xml?key=3RhAfUy69AUuQhOv1gTcA&id=" +\
                    str(row['goodreads_book_id'])
        resp = requests.get(query_url).content
        resp_dict = xmltodict.parse(resp)
        bookInfo = resp_dict.get('GoodreadsResponse').get('book')
        try:
            publication_date = datetime(int(bookInfo.get('publication_year')), int(bookInfo.get('publication_month')),
                                        int(bookInfo.get('publication_day')))
        except:
            publication_date = None

        book = Book(isbn=bookInfo.get('isbn'), title=bookInfo.get('title'),
                    publisher=bookInfo.get('publisher'), publication_date=publication_date,
                    description=bookInfo.get('description'), page_count=bookInfo.get('num_pages'),
                    image_url=bookInfo.get('image_url'), small_image_url=bookInfo.get('small_image_url'))

        db.session.add(book)
        db.session.commit()
        authorsInfo = bookInfo.get('authors').get('author')
        if type(authorsInfo) is not list:
            authorsInfo = [authorsInfo]
        print(authorsInfo)
        for authorInfo in authorsInfo:
            print(authorInfo, '-----')
            author = get_author(authorInfo, author_ids)
            authorBookLink = AuthorBookLink(author=author, book=book)
            author.books.append(authorBookLink)
            book.authors.append(authorBookLink)
            db.session.commit()

        nr_books += 1
        print(nr_books)

        db.session.commit()

    print(cnt)


'''
OrderedDict([('GoodreadsResponse', 
OrderedDict([('Request', 
OrderedDict([('authentication', 'true'), 
('key', '3RhAfUy69AUuQhOv1gTcA'), ('method', 'book_show')])), 
('book', OrderedDict([('id', '1'), ('title', 'Harry Potter and the Half-Blood Prince (Harry Potter, #6)'), 
'isbn', None), ('isbn13', None), ('asin', None), ('kindle_asin', None), ('marketplace_id', None), ('country_code', 'RO'), 
('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1156039812l/1._SX98_.jpg'), 
('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1156039812l/1._SY75_.jpg'), 
('publication_year', '2006'), ('publication_month', '9'), ('publication_day', '16'), ('publisher', 'Scholastic Inc.'), 
('language_code', 'eng'), ('is_ebook', 'false'), 
('description', 'When Harry Potter and the Half-Blood Prince opens, the war against Voldemort has begun. The Wizarding world has split down the middle, and as the casualties mount, the effects even spill over onto the Muggles. Dumbledore is away from Hogwarts for long periods, and the Order of the Phoenix has suffered grievous losses. And yet, as in all wars, life goes on.<br /><br />Harry, Ron, and Hermione, having passed their O.W.L. level exams, start on their specialist N.E.W.T. courses. Sixth-year students learn to Apparate, losing a few eyebrows in the process. Teenagers flirt and fight and fall in love. Harry becomes captain of the Gryffindor Quidditch team, while Draco Malfoy pursues 
his own dark ends. And classes are as fascinating and confounding as ever, as Harry receives some extraordinary help in Potions from the mysterious Half-Blood Prince.<br /><br />Most importantly, Dumbledore and Harry work together to uncover the full and complex story of a boy once named Tom Riddle—the boy who became Lord Voldemort. Like Harry, he was the son of one Muggle-born and one Wizarding parent, raised unloved, and a speaker of Parseltongue. But the similarities end there, as the teenaged Riddle became deeply interested in the Dark objects known as Horcruxes: objects in which a wizard can hide part of his soul, if he dares splinter that soul through murder.<br /><br />Harry must use all the tools at his disposal to draw a final secret out of one of Riddle’s teachers, the sly Potions professor Horace Slughorn. Finally Harry and Dumbledore hold the key to the Dark Lord’s weaknesses... until a shocking reversal exposes Dumbledore’s own vulnerabilities, and casts Harry’s—and Hogwarts’s—future in shadow.<br /><br />Source: <a target="_blank" href="http://harrypotter.scholastic.com" rel="nofollow">http://harrypotter.scholastic.com</a>'), ('work', OrderedDict([('id', OrderedDict([('@type', 'integer'), ('#text', '41335427')])), ('books_count', OrderedDict([('@type', 'integer'), ('#text', '366')])), ('best_book_id', OrderedDict([('@type', 'integer'), ('#text', '1')])), ('reviews_count', OrderedDict([('@type', 'integer'), ('#text', '2898239')])), ('ratings_sum', OrderedDict([('@type', 'integer'), ('#text', '10502050')])), ('ratings_count', OrderedDict([('@type', 'integer'), ('#text', '2298847')])), ('text_reviews_count', OrderedDict([('@type', 'integer'), ('#text', '36563')])), ('original_publication_year', OrderedDict([('@type', 'integer'), ('#text', '2005')])), ('original_publication_month', OrderedDict([('@type', 'integer'), ('#text', '7')])), ('original_publication_day', OrderedDict([('@type', 'integer'), ('#text', '16')])), ('original_title', 'Harry Potter and the Half-Blood Prince'), ('original_language_id', OrderedDict([('@type', 'integer'), ('@nil', 'true')])), ('media_type', 'book'), 
('rating_dist', '5:1547010|4:556614|3:160000|2:25321|1:9902|total:2298847'), ('desc_user_id', OrderedDict([('@type', 'integer'), ('#text', '34963304')])), ('default_chaptering_book_id', OrderedDict([('@type', 'integer'), ('#text', '1')])), ('default_description_language_code', OrderedDict([('@nil', 'true')])), ('work_uri', 'kca://work/amzn1.gr.work.v1.txipecnIYua0HbI4GhIAkA')])), ('average_rating', '4.57'), ('num_pages', '652'), ('format', 'Paperback'), ('edition_information', None), ('ratings_count', '2130593'), ('text_reviews_count', '28075'), ('url', 'https://www.goodreads.com/book/show/1.Harry_Potter_and_the_Half_Blood_Prince'), ('link', 'https://www.goodreads.com/book/show/1.Harry_Potter_and_the_Half_Blood_Prince'), 
('authors', OrderedDict([('author', [OrderedDict([('id', '1077326'), ('name', 'J.K. Rowling'), ('role', None), ('image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1510435123p5/1077326.jpg')])), ('small_image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1510435123p2/1077326.jpg')])), ('link', 'https://www.goodreads.com/author/show/1077326.J_K_Rowling'), ('average_rating', '4.46'), ('ratings_count', '24376230'), ('text_reviews_count', '575358')]), OrderedDict([('id', '2927'), ('name', 'Mary GrandPré'), ('role', 'Illustrator'), ('image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1395344820p5/2927.jpg')])), ('small_image_url', OrderedDict([('@nophoto', 'false'), ('#text', 'https://images.gr-assets.com/authors/1395344820p2/2927.jpg')])), ('link', 'https://www.goodreads.com/author/show/2927.Mary_GrandPr_'), ('average_rating', '4.53'), ('ratings_count', '4670949'), ('text_reviews_count', '76573')])])])), ('reviews_widget', '<style>\n  #goodreads-widget {\n    font-family: georgia, serif;\n    padding: 18px 0;\n    width:565px;\n  }\n  #goodreads-widget h1 {\n    font-weight:normal;\n    font-size: 16px;\n    border-bottom: 1px solid #BBB596;\n    margin-bottom: 0;\n  }\n  #goodreads-widget a {\n    text-decoration: none;\n    color:#660;\n  }\n  iframe{\n    background-color: #fff;\n  }\n  #goodreads-widget a:hover { text-decoration: underline; }\n  #goodreads-widget a:active {\n    color:#660;\n  }\n  #gr_footer {\n    width: 100%;\n    border-top: 1px solid #BBB596;\n    text-align: right;\n  }\n  #goodreads-widget .gr_branding{\n    color: #382110;\n    font-size: 11px;\n    text-decoration: none;\n    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;\n  }\n</style>\n<div id="goodreads-widget">\n  <div id="gr_header"><h1><a rel="nofollow" href="https://www.goodreads.com/book/show/1.Harry_Potter_and_the_Half_Blood_Prince">Harry Potter and the Half-Blood Prince Reviews</a></h1></div>\n  <iframe id="the_iframe" src="https://www.goodreads.com/api/reviews_widget_iframe?did=DEVELOPER_ID&amp;format=html&amp;links=660&amp;min_rating=&amp;review_back=fff&amp;stars=000&amp;text=000" width="565" height="400" frameborder="0"></iframe>\n  <div id="gr_footer">\n    <a class="gr_branding" target="_blank" rel="nofollow noopener noreferrer" href="https://www.goodreads.com/book/show/1.Harry_Potter_and_the_Half_Blood_Prince?utm_medium=api&amp;utm_source=reviews_widget">Reviews from Goodreads.com</a>\n  </div>\n</div>'), ('popular_shelves', OrderedDict([('shelf', [OrderedDict([('@name', 'to-read'), ('@count', '281377')]), OrderedDict([('@name', 'fantasy'), ('@count', '45470')]), OrderedDict([('@name', 'favorites'), ('@count', '38834')]), OrderedDict([('@name', 'currently-reading'), ('@count', '28207')]), OrderedDict([('@name', 'young-adult'), ('@count', '14865')]), OrderedDict([('@name', 'fiction'), ('@count', '12777')]), OrderedDict([('@name', 'harry-potter'), ('@count', '8891')]), OrderedDict([('@name', 'books-i-own'), ('@count', '7667')]), OrderedDict([('@name', 'owned'), ('@count', '7070')]), OrderedDict([('@name', 'ya'), ('@count', '5351')]), OrderedDict([('@name', 'series'), ('@count', '4642')]), OrderedDict([('@name', 'favourites'), ('@count', '4305')]), OrderedDict([('@name', 'magic'), ('@count', '3778')]), OrderedDict([('@name', 'childrens'), ('@count', '2664')]), OrderedDict([('@name', 'owned-books'), ('@count', '2195')]), OrderedDict([('@name', 're-read'), ('@count', '2180')]), OrderedDict([('@name', 'adventure'), ('@count', '1923')]), OrderedDict([('@name', 'children'), ('@count', '1757')]), OrderedDict([('@name', 'audiobook'), ('@count', '1536')]), OrderedDict([('@name', 'j-k-rowling'), ('@count', '1490')]), OrderedDict([('@name', 'audiobooks'), ('@count', '1462')]), OrderedDict([('@name', 'childhood'), ('@count', '1357')]), OrderedDict([('@name', 'all-time-favorites'), ('@count', '1291')]), OrderedDict([('@name', 'my-books'), ('@count', '1285')]), OrderedDict([('@name', 'children-s'), ('@count', '1255')]), OrderedDict([('@name', 'middle-grade'), ('@count', '1255')]), OrderedDict([('@name', 'sci-fi-fantasy'), ('@count', '1254')]), OrderedDict([('@name', 'classics'), ('@count', '1211')]), OrderedDict([('@name', 'default'), ('@count', '1173')]), OrderedDict([('@name', 'reread'), ('@count', '1155')]), OrderedDict([('@name', '5-stars'), ('@count', '1133')]), OrderedDict([('@name', 'my-library'), ('@count', '960')]), OrderedDict([('@name', 'novels'), ('@count', '935')]), OrderedDict([('@name', 'i-own'), ('@count', '923')]), OrderedDict([('@name', 'favorite-books'), ('@count', '907')]), OrderedDict([('@name', 'children-s-books'), ('@count', '904')]), OrderedDict([('@name', 'kids'), ('@count', '868')]), OrderedDict([('@name', 'favorite'), ('@count', '859')]), OrderedDict([('@name', 'fantasy-sci-fi'), ('@count', '837')]), OrderedDict([('@name', 'ya-fantasy'), ('@count', '832')]), OrderedDict([('@name', 'english'), ('@count', '719')]), OrderedDict([('@name', 'audio'), ('@count', '708')]), OrderedDict([('@name', 'paranormal'), ('@count', '708')]), OrderedDict([('@name', 'read-more-than-once'), ('@count', '685')]), OrderedDict([('@name', 'urban-fantasy'), ('@count', '664')]), OrderedDict([('@name', 'books'), ('@count', '663')]), OrderedDict([('@name', 'library'), ('@count', '644')]), OrderedDict([('@name', 'teen'), 
('@count', '639')]), 
OrderedDict([('@name', 're-reads'), ('@count', '625')]), 
OrderedDict([('@name', 'witches'), ('@count', '625')]), 
OrderedDict([('@name', 'jk-rowling'), ('@count', '604')]), 
OrderedDict([('@name', 'british'), ('@count', '597')]), 
OrderedDict([('@name', 'mystery'), ('@count', '557')]), 
OrderedDict([('@name', 'ya-fiction'), ('@count', '551')]),
 OrderedDict([('@name', 'my-favorites'), ('@count', '518')]), 
 OrderedDict([('@name', 'novel'), ('@count', '517')]), OrderedDict([('@name', 'read-in-2016'), 
 ('@count', '507')]), OrderedDict([('@name', 'childrens-books'), ('@count', '507')]),
  OrderedDict([('@name', 'supernatural'), ('@count', '507')]), OrderedDict([('@name', 'own-it'), ('@count', '506')]), 
  OrderedDict([('@name', 'harry-potter-series'), ('@count', '503')]), OrderedDict([('@name', 'faves'), ('@count', '502')]), 
  OrderedDict([('@name', 'read-in-2017'), ('@count', '501')]), OrderedDict([('@name', 'kindle'), ('@count', '486')]), 
  OrderedDict([('@name', 'bookshelf'), ('@count', '477')]), OrderedDict([('@name', 'read-in-2019'), ('@count', '472')]),
   OrderedDict([('@name', 'read-in-2018'), ('@count', '462')]), OrderedDict([('@name', '2005'), ('@count', '457')]), 
   OrderedDict([('@name', 'scifi-fantasy'), ('@count', '447')]), OrderedDict([('@name', 'young-adult-fiction'), ('@count', '446')]), 
   OrderedDict([('@name', 'my-bookshelf'), ('@count', '442')]), OrderedDict([('@name', 'on-my-shelf'), ('@count', '431')]), 
   OrderedDict([('@name', 'rereads'), ('@count', '426')]), OrderedDict([('@name', 'favorite-series'), ('@count', '410')]), 
   OrderedDict([('@name', 'all-time-favourites'), ('@count', '403')]), OrderedDict([('@name', '5-star'), ('@count', '403')]), 
   OrderedDict([('@name', 'favourite'), ('@count', '395')]), OrderedDict([('@name', 'wizards'), ('@count', '394')]), 
   OrderedDict([('@name', 'youth'), ('@count', '392')]), OrderedDict([('@name', 'favs'), ('@count', '390')]), 
   OrderedDict([('@name', 'childhood-favorites'), ('@count', '389')]), OrderedDict([('@name', 'made-me-cry'), ('@count', '388')]), 
   OrderedDict([('@name', 'coming-of-age'), ('@count', '383')]), OrderedDict([('@name', 'ebook'), ('@count', '380')]), 
   OrderedDict([('@name', 'juvenile'), ('@count', '380')]), OrderedDict([('@name', 'romance'), ('@count', '379')]), 
   OrderedDict([('@name', 'audio-books'), ('@count', '373')]), OrderedDict([('@name', 'audible'), ('@count', '362')]), 
   OrderedDict([('@name', 'read-in-2015'), ('@count', '357')]), OrderedDict([('@name', 'read-in-english'), ('@count', '356')]), 
   OrderedDict([('@name', 'kids-books'), ('@count', '356')]), OrderedDict([('@name', 'to-buy'), ('@count', '353')]), 
   OrderedDict([('@name', 'fantasia'), ('@count', '349')]), OrderedDict([('@name', 'childhood-books'), ('@count', '349')]), 
   OrderedDict([('@name', 'hp'), ('@count', '338')]), OrderedDict([('@name', 'have'), 
('@count', '328')]), OrderedDict([('@name', 'contemporary'), ('@count', '325')]), OrderedDict([('@name', 'england'), 
('@count', '320')]), OrderedDict([('@name', 'children-s-literature'), ('@count', '319')]), OrderedDict([('@name', 'kindle-unlimited'), 
('@count', '318')])])])), 
('book_links', OrderedDict([('book_link', OrderedDict([('id', '8'), ('name', 'Libraries'), 
('link', 'https://www.goodreads.com/book_link/follow/8')]))])), 
('buy_links', OrderedDict([('buy_link', [OrderedDict([('id', '1'), ('name', 'Amazon'), 
('link', 'https://www.goodreads.com/book_link/follow/1')]), OrderedDict([('id', '10'), ('name', 'Audible'), 
('link', 'https://www.goodreads.com/book_link/follow/10')]), OrderedDict([('id', '3'), ('name', 'Barnes & Noble'), 
('link', 'https://www.goodreads.com/book_link/follow/3')]), OrderedDict([('id', '1027'), ('name', 'Walmart eBooks'), 
('link', 'https://www.goodreads.com/book_link/follow/1027')]), OrderedDict([('id', '2102'), ('name', 'Apple Books'), 
('link', 'https://www.goodreads.com/book_link/follow/2102')]), OrderedDict([('id', '8036'), ('name', 'Google Play'), 
('link', 'https://www.goodreads.com/book_link/follow/8036')]), OrderedDict([('id', '4'), ('name', 'Abebooks'),
 ('link', 'https://www.goodreads.com/book_link/follow/4')]), OrderedDict([('id', '882'), ('name', 'Book Depository'), 
 ('link', 'https://www.goodreads.com/book_link/follow/882')]), OrderedDict([('id', '5'), ('name', 'Alibris'), 
 ('link', 'https://www.goodreads.com/book_link/follow/5')]), OrderedDict([('id', '9'), ('name', 'Indigo'), 
 ('link', 'https://www.goodreads.com/book_link/follow/9')]), OrderedDict([('id', '107'), ('name', 'Better World Books'), 
 ('link', 'https://www.goodreads.com/book_link/follow/107')]), OrderedDict([('id', '7'), ('name', 'IndieBound'), 
 ('link', 'https://www.goodreads.com/book_link/follow/7')])])])), 
 ('series_works', OrderedDict([('series_work', OrderedDict([('id', '624922'), ('user_position', '6'),
  ('series', OrderedDict([('id', '45175'), ('title', 'Harry Potter'), 
  ('description', 'Orphan Harry learns he is a wizard on his 11th birthday when Hagrid escorts him to magic-teaching Hogwarts School. As a baby, his mother\'s love protected him and vanquished the villain Voldemort, leaving the child famous as "The Boy who Lived". With his friends Hermione and Ron, Harry has to defeat the returned "He Who Must Not Be Named".'), ('note', 'Cursed Child is NOT a Primary Work. Boxsets ARE part of the series. However, the mini-shorts are NOT books by Goodreads standards, and should neither be added to this series nor to the database.'), ('series_works_count', '16'), ('primary_work_count', '7'), ('numbered', 'true')]))]))])), ('similar_books', OrderedDict([('book', [OrderedDict([('id', '29056083'), ('title', 'Harry Potter and the Cursed Child: Parts One and Two (Harry Potter, #8)'), ('title_without_series', 'Harry Potter and the Cursed Child: Parts One and Two'), ('link', 'https://www.goodreads.com/book/show/29056083-harry-potter-and-the-cursed-child'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1470082995l/29056083._SY75_.jpg'), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1470082995l/29056083._SX98_.jpg'), ('num_pages', '343'), ('work', OrderedDict([('id', '48765776')])), ('isbn', '0751565350'), ('isbn13', '9780751565355'), ('average_rating', '4.57'), ('ratings_count', '2298847'), ('publication_year', '2016'), ('publication_month', '7'), ('publication_day', '31'), ('authors', OrderedDict([('author', OrderedDict([('id', '5042201'), ('name', 'John Tiffany'), ('link', 'https://www.goodreads.com/author/show/5042201.John_Tiffany')]))]))]), OrderedDict([('id', '7260188'), ('title', 'Mockingjay (The Hunger Games, #3)'), ('title_without_series', 'Mockingjay'), ('link', 'https://www.goodreads.com/book/show/7260188-mockingjay'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1586722918l/7260188._SY75_.jpg'), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1586722918l/7260188._SX98_.jpg'), ('num_pages', '390'), ('work', OrderedDict([('id', '8812783')])), ('isbn', '0439023513'), ('isbn13', '9780439023511'), ('average_rating', '4.57'), ('ratings_count', '2298847'), ('publication_year', '2010'), ('publication_month', '8'), ('publication_day', '24'), ('authors', OrderedDict([('author', OrderedDict([('id', '153394'), ('name', 'Suzanne Collins'), ('link', 'https://www.goodreads.com/author/show/153394.Suzanne_Collins')]))]))]), OrderedDict([('id', '6148028'), ('title', 'Catching Fire (The Hunger Games, #2)'), ('title_without_series', 'Catching Fire'), ('link', 'https://www.goodreads.com/book/show/6148028-catching-fire'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1586722941l/6148028._SY75_.jpg'), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1586722941l/6148028._SX98_.jpg'), ('num_pages', '391'), ('work', OrderedDict([('id', '6171458')])), ('isbn', '0439023491'), ('isbn13', '9780439023498'), ('average_rating', '4.57'), ('ratings_count', '2298847'), ('publication_year', '2009'), ('publication_month', '9'), ('publication_day', '1'), ('authors', OrderedDict([('author', OrderedDict([('id', '153394'), ('name', 'Suzanne Collins'), ('link', 'https://www.goodreads.com/author/show/153394.Suzanne_Collins')]))]))]), OrderedDict([('id', '49041'), ('title', 'New Moon (Twilight, #2)'), ('title_without_series', 'New Moon'), ('link', 'https://www.goodreads.com/book/show/49041.New_Moon'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1361039440l/49041._SY75_.jpg'), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1361039440l/49041._SX98_.jpg'), ('num_pages', '563'), ('work', OrderedDict([('id', '3203964')])), ('isbn', '0316160199'), ('isbn13', '9780316160193'), ('average_rating', '4.57'), ('ratings_count', '2298847'), ('publication_year', '2006'), ('publication_month', '9'), ('publication_day', '6'), ('authors', OrderedDict([('author', OrderedDict([('id', '941441'), ('name', 'Stephenie Meyer'), ('link', 'https://www.goodreads.com/author/show/941441.Stephenie_Meyer')]))]))]), OrderedDict([('id', '428263'), ('title', 'Eclipse (Twilight, #3)'), ('title_without_series', 'Eclipse'), ('link', 'https://www.goodreads.com/book/show/428263.Eclipse'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1361038355l/428263._SY75_.jpg'), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1361038355l/428263._SX98_.jpg'), ('num_pages', '629'), ('work', OrderedDict([('id', '2675454')])), ('isbn', '0316160202'), ('isbn13', '9780316160209'), ('average_rating', '4.57'), ('ratings_count', '2298847'), ('publication_year', '2007'), ('publication_month', '8'), ('publication_day', '7'), ('authors', OrderedDict([('author', OrderedDict([('id', '941441'), ('name', 'Stephenie Meyer'), ('link', 'https://www.goodreads.com/author/show/941441.Stephenie_Meyer')]))]))]), OrderedDict([('id', '1162543'), ('title', 'Breaking Dawn (Twilight, #4)'), ('title_without_series', 'Breaking Dawn'), ('link', 'https://www.goodreads.com/book/show/1162543.Breaking_Dawn'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1361039438l/1162543._SY75_.jpg'), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1361039438l/1162543._SX98_.jpg'), ('num_pages', '756'), ('work', OrderedDict([('id', '2960529')])), ('isbn', '031606792X'), ('isbn13', '9780316067928'), ('average_rating', '4.57'), ('ratings_count', '2298847'), ('publication_year', '2008'), ('publication_month', '8'), ('publication_day', '2'), ('authors', OrderedDict([('author', OrderedDict([('id', '941441'), ('name', 'Stephenie Meyer'), ('link', 'https://www.goodreads.com/author/show/941441.Stephenie_Meyer')]))]))]), OrderedDict([('id', '15241'), ('title', 'The Two Towers (The Lord of the Rings, #2)'), ('title_without_series', 'The Two Towers'), 
('link', 'https://www.goodreads.com/book/show/15241.The_Two_Towers'), 
('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1298415523l/15241._SY75_.jpg'), 
('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1298415523l/15241._SX98_.jpg'), 
('num_pages', '322'), 
('work', OrderedDict([('id', '2963845')])), 
('isbn', '0618346260'), ('isbn13', '9780618346264'), 
('average_rating', '4.57'), ('ratings_count', '2298847'), 
('publication_year', '2003'), ('publication_month', '9'), 
('publication_day', '5'), 
('authors', OrderedDict([('author', OrderedDict([('id', '656983'), ('name', 'J.R.R. Tolkien'), ('link', 'https://www.goodreads.com/author/show/656983.J_R_R_Tolkien')]))]))]), OrderedDict([('id', '18512'), ('title', 'The Return of the King (The Lord of the Rings, #3)'), ('title_without_series', 'The Return of the King'), ('link', 'https://www.goodreads.com/book/show/18512.The_Return_of_the_King'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1520258755l/18512._SY75_.jpg'), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1520258755l/18512._SY160_.jpg'), ('num_pages', '404'), ('work', OrderedDict([('id', '2964424')])), ('isbn', None), ('isbn13', None), ('average_rating', '4.57'), ('ratings_count', '2298847'), ('publication_year', '2003'), ('publication_month', None), ('publication_day', None), ('authors', OrderedDict([('author', OrderedDict([('id', '656983'), ('name', 'J.R.R. Tolkien'), ('link', 'https://www.goodreads.com/author/show/656983.J_R_R_Tolkien')]))]))]), OrderedDict([('id', '5907'), 
('title', 'The Hobbit, or There and Back Again'), ('title_without_series', 'The Hobbit, or There and Back Again'), ('link', 'https://www.goodreads.com/book/show/5907.The_Hobbit_or_There_and_Back_Again'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1546071216l/5907._SY75_.jpg'), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1546071216l/5907._SX98_.jpg'), ('num_pages', '366'), ('work', OrderedDict([('id', '1540236')])), ('isbn', '0618260307'), ('isbn13', '9780618260300'), ('average_rating', '4.57'), ('ratings_count', '2298847'), ('publication_year', '2002'), ('publication_month', '8'), ('publication_day', '15'), ('authors', OrderedDict([('author', OrderedDict([('id', '656983'), ('name', 'J.R.R. Tolkien'), ('link', 'https://www.goodreads.com/author/show/656983.J_R_R_Tolkien')]))]))]), OrderedDict([('id', '968'), ('title', 'The Da Vinci Code (Robert Langdon, #2)'), ('title_without_series', 'The Da Vinci Code'), ('link', 'https://www.goodreads.com/book/show/968.The_Da_Vinci_Code'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1579621267l/968._SY75_.jpg'), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1579621267l/968._SX98_.jpg'), ('num_pages', 
'489'), ('work', OrderedDict([('id', '2982101')])), ('isbn', '0307277674'), ('isbn13', '9780307277671'), ('average_rating', '4.57'), ('ratings_count', '2298847'), ('publication_year', '2006'), ('publication_month', '3'), ('publication_day', '28'), ('authors', OrderedDict([('author', OrderedDict([('id', '630'), ('name', 'Dan Brown'), ('link', 'https://www.goodreads.com/author/show/630.Dan_Brown')]))]))]), OrderedDict([('id', '41899'), ('title', 'Fantastic Beasts and Where to Find Them (Hogwarts Library)'), ('title_without_series', 'Fantastic Beasts and Where to Find Them'), ('link', 'https://www.goodreads.com/book/show/41899.Fantastic_Beasts_and_Where_to_Find_Them'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1303738520l/41899._SX50_.jpg'), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1303738520l/41899._SX98_.jpg'), ('num_pages', '128'), ('work', OrderedDict([('id', '4195128')])), ('isbn', '0439321603'), ('isbn13', '9780439321600'), ('average_rating', '4.57'), ('ratings_count', '2298847'), ('publication_year', '2001'), ('publication_month', '6'), ('publication_day', '1'), ('authors', OrderedDict([('author', OrderedDict([('id', '19981845'), ('name', 'Newt Scamander'), ('link', 'https://www.goodreads.com/author/show/19981845.Newt_Scamander')]))]))]), OrderedDict([('id', '2283433'), ('title', 'Selections from Harry Potter and the Order of the Phoenix: Piano Solos'), ('title_without_series', 'Selections from Harry Potter and the Order of the Phoenix: Piano Solos'), ('link', 'https://www.goodreads.com/book/show/2283433.Selections_from_Harry_Potter_and_the_Order_of_the_Phoenix'), ('small_image_url', 'https://s.gr-assets.com/assets/nophoto/book/50x75-a91bf249278a81aabab721ef782c4a74.png'), ('image_url', 'https://s.gr-assets.com/assets/nophoto/book/111x148-bcc042a9c91a29c1d680899eff700a03.png'), ('num_pages', '37'), ('work', OrderedDict([('id', '2289636')])), ('isbn', '0739049216'), ('isbn13', '9780739049211'), ('average_rating', '4.57'), ('ratings_count', '2298847'), ('publication_year', '2007'), ('publication_month', '7'), ('publication_day', '1'), ('authors', OrderedDict([('author', OrderedDict([('id', '616'), ('name', 'John   Williams'), ('link', 'https://www.goodreads.com/author/show/616.John_Williams')]))]))]), OrderedDict([('id', '28186'), ('title', 'The Sea of Monsters (Percy Jackson and the Olympians, #2)'), ('title_without_series', 'The Sea of Monsters'), ('link', 'https://www.goodreads.com/book/show/28186.The_Sea_of_Monsters'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1400602661l/28186._SX50_.jpg'), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1400602661l/28186._SX98_.jpg'), ('num_pages', '279'), ('work', OrderedDict([('id', '43554')])), ('isbn', '0786856866'), ('isbn13', '9780786856862'), ('average_rating', '4.57'), ('ratings_count', '2298847'), ('publication_year', '2006'), ('publication_month', '4'), ('publication_day', '1'), ('authors', OrderedDict([('author', OrderedDict([('id', '15872'), ('name', 'Rick Riordan'), ('link', 'https://www.goodreads.com/author/show/15872.Rick_Riordan')]))]))]), OrderedDict([('id', '34'), ('title', 'The Fellowship of the Ring (The Lord of the Rings, 
#1)'), ('title_without_series', 'The Fellowship of the Ring'), ('link', 'https://www.goodreads.com/book/show/34.The_Fellowship_of_the_Ring'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1298411339l/34._SX50_.jpg'), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1298411339l/34._SX98_.jpg'), ('num_pages', '398'), ('work', OrderedDict([('id', '3204327')])), ('isbn', '0618346252'), ('isbn13', '9780618346257'), ('average_rating', '4.57'), ('ratings_count', '2298847'), ('publication_year', '2003'), ('publication_month', '9'), ('publication_day', '5'), ('authors', OrderedDict([('author', OrderedDict([('id', '656983'), ('name', 'J.R.R. Tolkien'), ('link', 'https://www.goodreads.com/author/show/656983.J_R_R_Tolkien')]))]))]), OrderedDict([('id', '11735983'), ('title', 'Insurgent (Divergent, #2)'), ('title_without_series', 'Insurgent'), ('link', 'https://www.goodreads.com/book/show/11735983-insurgent'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1325667729l/11735983._SY75_.jpg'), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1325667729l/11735983._SX98_.jpg'), ('num_pages', '525'), ('work', OrderedDict([('id', '15524542')])), ('isbn', '0007442912'), ('isbn13', '9780007442911'), ('average_rating', '4.57'), ('ratings_count', '2298847'), ('publication_year', '2012'), ('publication_month', '5'), ('publication_day', 
'1'), ('authors', OrderedDict([('author', OrderedDict([('id', '4039811'), ('name', 'Veronica Roth'), ('link', 'https://www.goodreads.com/author/show/4039811.Veronica_Roth')]))]))]), OrderedDict([('id', '2223324'), ('title', 'Harry Potter and the Chamber of Secrets: Sheet Music for Flute with C.D'), ('title_without_series', 'Harry 
Potter and the Chamber of Secrets: Sheet Music for Flute with C.D'), ('link', 'https://www.goodreads.com/book/show/2223324.Harry_Potter_and_the_Chamber_of_Secrets'), 
('small_image_url', 'https://s.gr-assets.com/assets/nophoto/book/50x75-a91bf249278a81aabab721ef782c4a74.png'), ('image_url', 'https://s.gr-assets.com/assets/nophoto/book/111x148-bcc042a9c91a29c1d680899eff700a03.png'), ('num_pages', None), ('work', OrderedDict([('id', '498223')])), ('isbn', '075791084X'), ('isbn13', '9780757910845'), ('average_rating', '4.57'), ('ratings_count', '2298847'), ('publication_year', None), ('publication_month', None), ('publication_day', None), ('authors', OrderedDict([('author', OrderedDict([('id', '616'), ('name', 'John   Williams'), ('link', 'https://www.goodreads.com/author/show/616.John_Williams')]))]))]), OrderedDict([('id', '28187'), ('title', 'The Lightning Thief (Percy Jackson and the Olympians, #1)'), ('title_without_series', 'The Lightning Thief'), ('link', 'https://www.goodreads.com/book/show/28187.The_Lightning_Thief'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1400602609l/28187._SY75_.jpg'), 
('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1400602609l/28187._SX98_.jpg'), ('num_pages', '375'), ('work', OrderedDict([('id', '3346751')])), ('isbn', '0786838655'), ('isbn13', '9780786838653'), ('average_rating', '4.57'), ('ratings_count', '2298847'), ('publication_year', '2006'), ('publication_month', '3'), ('publication_day', '1'), ('authors', OrderedDict([('author', OrderedDict([('id', '15872'), ('name', 'Rick Riordan'), ('link', 'https://www.goodreads.com/author/show/15872.Rick_Riordan')]))]))]), OrderedDict([('id', '111450'), ('title', 'Quidditch Through the Ages (Hogwarts Library)'), ('title_without_series', 
'Quidditch Through the Ages'), ('link', 'https://www.goodreads.com/book/show/111450.Quidditch_Through_the_Ages'), ('small_image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1369689506l/111450._SX50_.jpg'), ('image_url', 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1369689506l/111450._SX98_.jpg'), ('num_pages', '56'), ('work', OrderedDict([('id', '6247751')])), ('isbn', '0439321611'), ('isbn13', '9780439321617'), ('average_rating', '4.57'), ('ratings_count', '2298847'), ('publication_year', '2001'), ('publication_month', '6'), ('publication_day', '1'), ('authors', OrderedDict([('author', OrderedDict([('id', '57990'), ('name', 'Kennilworthy Whisp'), ('link', 'https://www.goodreads.com/author/show/57990.Kennilworthy_Whisp')]))]))])])]))]))]))])
'''
